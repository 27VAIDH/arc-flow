{
  "project": "ArcFlow",
  "branchName": "ralph/v1.1-delight-stickiness",
  "description": "ArcFlow v1.1 â€” Workspace Templates, Tab Preview on Hover, Quick Notes per Workspace",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add WorkspaceTemplate type and template data definitions",
      "description": "As a developer, I want workspace templates defined as static typed data so that template features have a reliable, type-safe data source. Add WorkspaceTemplate interface to src/shared/types.ts and create src/shared/templates.ts with 6 template definitions.",
      "acceptanceCriteria": [
        "WorkspaceTemplate type defined in src/shared/types.ts with fields: id (string), name (string), emoji (string), accentColor (string), pinnedApps ({ url: string, title: string }[]), folders (string[])",
        "6 templates defined in new file src/shared/templates.ts: Developer (ðŸ’», #22C55E), Student (ðŸ“š, #3B82F6), Creative (ðŸŽ¨, #EC4899), Work (ðŸ’¼, #F59E0B), Research (ðŸ”¬, #8B5CF6), Personal (ðŸ , #EF4444)",
        "Developer template pinned apps: GitHub (github.com), StackOverflow (stackoverflow.com), MDN (developer.mozilla.org), localhost:3000 (http://localhost:3000), npm (npmjs.com). Folders: Repos, Docs, Issues",
        "Student template pinned apps: Google Drive (drive.google.com), Notion (notion.so), Canvas (canvas.instructure.com), Wikipedia (en.wikipedia.org), Google Scholar (scholar.google.com). Folders: Courses, Research, Assignments",
        "Creative template pinned apps: Figma (figma.com), Dribbble (dribbble.com), Behance (behance.net), Pinterest (pinterest.com), Coolors (coolors.co). Folders: Inspiration, Projects, Assets",
        "Work template pinned apps: Gmail (mail.google.com), Slack (app.slack.com), Notion (notion.so), Google Calendar (calendar.google.com), Jira (atlassian.com/software/jira). Folders: Projects, Meetings, References",
        "Research template pinned apps: Google Scholar (scholar.google.com), PubMed (pubmed.ncbi.nlm.nih.gov), Zotero (zotero.org), arXiv (arxiv.org), Wikipedia (en.wikipedia.org). Folders: Papers, Notes, Data",
        "Personal template pinned apps: Gmail (mail.google.com), YouTube (youtube.com), Reddit (reddit.com), Twitter/X (x.com), Netflix (netflix.com). Folders: Entertainment, Shopping, Bookmarks",
        "Template data exported as WORKSPACE_TEMPLATES constant array",
        "Template IDs are kebab-case strings (developer, student, creative, work, research, personal)",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Add notes fields to Workspace type and implement v2 to v3 schema migration",
      "description": "As a developer, I want the workspace schema upgraded to include notes fields so that existing workspaces gain notes support without data loss. Extend the Workspace interface in types.ts and add migration logic in workspaceStorage.ts.",
      "acceptanceCriteria": [
        "Workspace interface in src/shared/types.ts gains 3 new fields: notes (string), notesCollapsed (boolean), notesLastEditedAt (number)",
        "SCHEMA_VERSION constant updated from 2 to 3 in workspaceStorage.ts",
        "migrateV2ToV3 function adds notes: '', notesCollapsed: true, notesLastEditedAt: 0 to each workspace",
        "Existing workspace data (name, emoji, accentColor, pinnedApps, folders, sortOrder) is preserved exactly by migration",
        "Migration runs automatically on extension load if current schema is v2 (integrated into existing getWorkspaces flow)",
        "Migration is idempotent â€” running on already-v3 data is a no-op (checks for existing fields)",
        "createWorkspace function in workspaceStorage.ts initializes new workspaces with notes: '', notesCollapsed: true, notesLastEditedAt: 0",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Implement createWorkspaceFromTemplate function in workspaceStorage",
      "description": "As a user, I want to create a workspace pre-populated with pinned apps and folders from a template so that I can start using a purpose-built workspace in seconds. Add createWorkspaceFromTemplate() to workspaceStorage.ts.",
      "acceptanceCriteria": [
        "createWorkspaceFromTemplate(templateId: string) function exported from workspaceStorage.ts",
        "Function looks up template by ID from WORKSPACE_TEMPLATES array",
        "Creates a new workspace with the template's name, emoji, and accentColor",
        "All template pinned apps are added to the new workspace with url and title fields",
        "All template folders are created as top-level empty folders in the workspace",
        "If a workspace with the same name already exists, the new workspace gets ' (2)' suffix (or incrementing number)",
        "The new workspace is set as the active workspace after creation via setActiveWorkspace",
        "No tabs are opened â€” function only sets up workspace structure in storage",
        "Function returns the created Workspace object",
        "Throws or returns error if templateId is not found",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Add get-tab-info message handler to service worker",
      "description": "As a developer, I want the service worker to respond with tab info (including last active time and workspace) so that the preview card can display data not available from the tabs API alone.",
      "acceptanceCriteria": [
        "Service worker handles messages with type 'get-tab-info' and tabId field",
        "Response includes lastActiveAt timestamp from the existing tab tracking data used for auto-archive",
        "Response includes workspaceName and workspaceEmoji by looking up tabWorkspaceMap and workspace data",
        "If tab is the currently active tab, lastActiveAt returns Date.now()",
        "If tab's workspace is unknown or not found, returns Default workspace info (name: 'Default', emoji: 'ðŸ“')",
        "Handler uses sendResponse pattern consistent with existing message handlers in service-worker.ts",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Build WorkspaceTemplates picker modal component",
      "description": "As a user, I want a modal to choose between a blank workspace and templates when creating a new workspace so I can see available options and pick one. Create WorkspaceTemplates.tsx as a self-contained modal component.",
      "acceptanceCriteria": [
        "New file src/sidepanel/WorkspaceTemplates.tsx created",
        "Component accepts props: isOpen (boolean), onClose (() => void), onCreate ((templateId: string | null) => void)",
        "Modal displays 'Create Workspace' title at top",
        "First option is 'Blank Workspace' (selected by default), represented as a card with âž• emoji",
        "Below that, a divider with text 'Or start from a template'",
        "6 template cards displayed in a 2-column grid layout",
        "Each template card shows: emoji (large ~24px), template name, 'X apps Â· Y folders' subtitle",
        "Clicking a card selects it with a visible highlight border using the template's accentColor",
        "Single-select behavior â€” clicking a different card deselects the previous one",
        "Create button at bottom calls onCreate with selected templateId (null for blank)",
        "Cancel button calls onClose without creating anything",
        "Escape key closes the modal",
        "Modal has dark mode support matching existing modal styling patterns",
        "Modal has role='dialog' and aria-modal='true' for accessibility",
        "Template cards have ARIA labels describing the template",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Integrate template picker into WorkspaceSwitcher creation flow",
      "description": "As a user, I want the '+' button in the workspace switcher to open the template picker modal instead of immediately creating a blank workspace so I can choose a template.",
      "acceptanceCriteria": [
        "Clicking '+' in WorkspaceSwitcher.tsx opens the WorkspaceTemplates modal instead of directly creating a workspace",
        "Selecting 'Blank Workspace' and clicking Create creates a workspace using existing createWorkspace() logic",
        "Selecting a template and clicking Create calls createWorkspaceFromTemplate() and switches to the new workspace",
        "After workspace is created, the modal closes and sidebar shows the new workspace content",
        "Cancel closes modal, no workspace created, sidebar unchanged",
        "The workspace switcher updates to show the new workspace icon after creation",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Add template selection to onboarding Step 2",
      "description": "As a first-time user, I want to select a workspace template during onboarding so that I start with a useful workspace structure from the very beginning.",
      "acceptanceCriteria": [
        "Onboarding Step 2 title changes from 'Create Your First Folder' to 'Set Up Your Workspace'",
        "Step 2 shows the 6 template cards in a scrollable grid (reusing WORKSPACE_TEMPLATES data)",
        "Users can select one template or leave none selected",
        "Skip button still works â€” proceeds to Step 3 without creating a template workspace",
        "Selecting a template and clicking Next creates the workspace via createWorkspaceFromTemplate()",
        "If no template selected, clicking Next proceeds to Step 3 without creating a template workspace (old folder creation behavior removed)",
        "Step 3 (Explore features) remains unchanged",
        "Template cards are styled appropriately within the onboarding overlay context",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Build QuickNotes component with auto-save",
      "description": "As a user, I want a collapsible notes area in the sidebar for the current workspace so I can jot down quick context, TODOs, and links related to my current task.",
      "acceptanceCriteria": [
        "New file src/sidepanel/QuickNotes.tsx created",
        "Component accepts props: workspaceId, notes, notesCollapsed, notesLastEditedAt, onNotesChange, onCollapseToggle",
        "Collapsed state shows a header row ~32px: notebook emoji, 'Notes' label, character count badge (e.g. '142'), expand chevron",
        "Clicking header or chevron toggles expanded/collapsed state via onCollapseToggle",
        "Expanded state shows a textarea with min-height 80px, max-height 200px, resize: vertical CSS",
        "Textarea placeholder rotates between 3 messages based on workspace context",
        "Typing in textarea calls onNotesChange debounced at 500ms (using setTimeout/clearTimeout pattern)",
        "Character limit of 2000 enforced via maxLength attribute on textarea",
        "Character counter 'X / 2000' appears only when content exceeds 1500 characters",
        "Below textarea: 'Last edited: X ago' in muted text using relative time format (just now, X minutes ago, X hours ago, etc.)",
        "Clear button with confirmation dialog empties the note",
        "Component supports dark and light mode with appropriate Tailwind classes",
        "Notes textarea has aria-label 'Workspace notes for [Workspace Name]'",
        "Collapse/expand button has aria-expanded attribute",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Integrate QuickNotes into App.tsx sidebar layout",
      "description": "As a user, I want the notes area to appear in the sidebar between the folder/tab tree and archive section so that it's accessible but not intrusive.",
      "acceptanceCriteria": [
        "QuickNotes component rendered in App.tsx between Zone 3 (folder/tab tree) and Zone 4 (archive section)",
        "Notes content comes from the active workspace's notes, notesCollapsed, and notesLastEditedAt fields",
        "Typing in notes saves to the active workspace via updateWorkspace() in workspaceStorage",
        "Toggling collapse updates the workspace's notesCollapsed field in storage",
        "Switching workspaces shows the switched-to workspace's note content immediately",
        "Notes auto-save writes are debounced â€” rapid typing does not cause excessive storage calls",
        "notesLastEditedAt is updated to Date.now() on each save",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Build TabPreviewCard component",
      "description": "As a developer, I want a reusable preview card component that displays rich tab info so that it can be triggered by hover events on tab entries.",
      "acceptanceCriteria": [
        "New file src/sidepanel/TabPreviewCard.tsx created",
        "Component renders: favicon (24x24), domain name, full page title (max 2 lines with word-wrap), full URL (smart truncated), last active relative time, workspace badge (emoji + name)",
        "Card is 280px wide with 12px padding and 8px border-radius",
        "URL display hides protocol (https://), truncates middle with '...' if path exceeds 60 chars",
        "URL has a small copy icon â€” clicking it copies the full URL to clipboard via navigator.clipboard.writeText",
        "Last active shows: 'Active now' (green dot) for current tab, 'Active just now' for <1min, 'Active X minutes ago', 'Active X hours ago', 'Active X days ago', or 'Active on [date]' for 7+ days",
        "Workspace badge shows workspace emoji and name in a small pill/badge",
        "Suspended tabs display 'Suspended' status text",
        "Audio-playing tabs display 'Playing audio' status text",
        "Card supports dark mode (gray-800 bg) and light mode (white bg) with subtle shadow",
        "Card renders as a React portal via ReactDOM.createPortal to escape sidebar overflow",
        "Component accepts position prop ({ top: number, left: number }) for absolute positioning",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 10,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Integrate tab hover preview trigger logic into App.tsx",
      "description": "As a user, I want the preview card to appear after a brief hover on a tab entry and disappear when I move away so I get useful info without disruption.",
      "acceptanceCriteria": [
        "Hovering over a tab entry in the folder/tab tree for 400ms triggers the TabPreviewCard",
        "Moving mouse away from the tab entry hides the card immediately",
        "Moving mouse from tab entry onto the card keeps it visible (for URL copying)",
        "Moving mouse away from the card hides it",
        "Quick mouse movement across multiple tabs does NOT flash cards (400ms delay prevents this)",
        "Only one preview card visible at a time",
        "No preview card for pinned apps row items (they have their own tooltips)",
        "No preview card for archive section entries",
        "Card position is calculated from tab entry getBoundingClientRect(), appearing to the right",
        "Card uses 100ms CSS fade-in animation via opacity transition",
        "Tab info (lastActiveAt, workspace) fetched via chrome.runtime.sendMessage get-tab-info on hover",
        "State management: hoveredTabId and previewPosition tracked in App.tsx or a custom hook",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 11,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Add Focus Notes command and integrate notes with session save/restore",
      "description": "As a user, I want notes to work seamlessly with existing features (command palette, sessions) so notes feel like a natural part of the workspace.",
      "acceptanceCriteria": [
        "Command palette includes 'Focus Notes' action that expands the notes area and focuses the textarea",
        "Focus Notes action works by setting notesCollapsed to false and calling .focus() on the textarea",
        "Session save/restore includes workspace notes in the snapshot (notes, notesCollapsed, notesLastEditedAt fields)",
        "Restoring a session restores the note content for that workspace",
        "Deleting a workspace automatically deletes its notes (no orphaned data â€” notes are part of workspace object)",
        "Workspace clone (if supported in current code) copies notes content",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 12,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Bump version to 1.1.0 and verify all features work together",
      "description": "As a developer, I want the extension version bumped and all v1.1 features verified working together so the release is ready.",
      "acceptanceCriteria": [
        "Version in manifest.json updated from 1.0.0 to 1.1.0",
        "Version in package.json updated to 1.1.0",
        "All three features work together without conflicts: create workspace from template, hover preview on its tabs, write notes",
        "Existing v1.0 features still work: pinned apps, folders, workspace switching, auto-archive, command palette, settings",
        "Schema migration from v2 data does not break existing workspaces",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 13,
      "passes": false,
      "notes": ""
    }
  ]
}
